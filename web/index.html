<!DOCTYPE html>
<html>

<head>
  <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
  <base href="$FLUTTER_BASE_HREF">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="A new Flutter project.">

  <!-- iOS meta tags & icons -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Studify">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png" />

  <title>Studify</title>
  <link rel="manifest" href="manifest.json">
</head>

<body>
  <div id="download-container" style="display: none; position: fixed; bottom: 20px; right: 20px; z-index: 9999;">
    <a href="studify.apk" download
      style="background-color: #0175C2; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; font-family: sans-serif; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
      Download Android App
    </a>
  </div>

  <script>
    function updateDownloadButtonVisibility() {
      var container = document.getElementById('download-container');
      if (!container) return;

      // Check current URL hash or path
      var href = window.location.href;
      // Show only if 'welcome', 'login', or 'register' is in the URL
      // Adjust this condition based on your actual routing (e.g., #/login)
      var shouldShow = href.includes('welcome') || href.includes('login') || href.includes('register');

      container.style.display = shouldShow ? 'block' : 'none';

      // If no hash/path is present (initial load might be root), deciding on default behavior.
      // Assuming root redirects to welcome/home, the router will update the URL eventually.
    }

    // Determine visibility on load
    window.addEventListener('load', updateDownloadButtonVisibility);

    // Listen for hash changes
    window.addEventListener('hashchange', updateDownloadButtonVisibility);

    // Also poll/listen for popstate to cover pushState navigations if necessary
    window.addEventListener('popstate', updateDownloadButtonVisibility);

    // MutationObserver to watch for URL changes if single-page app routing doesn't trigger standard events reliably
    // (Optional, but robust for some Flutter router implementations)
    var observer = new MutationObserver(function (mutations) {
      updateDownloadButtonVisibility();
    });
    // Observing body might be overkill, but observing title or just polling can work.
    // Let's stick to a simple polling interval as a fallback for Flutter's internal navigation
    setInterval(updateDownloadButtonVisibility, 500); 
  </script>

  <script src="flutter_bootstrap.js" async></script>
</body>

</html>